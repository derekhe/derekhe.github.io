<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="baidu-site-verification" content="aZ679hf2Rw"><title> 我是思聪</title><meta name="description" content="A Blog Powered By Hexo"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/prontera.css"><link rel="search" type="application/opensearchdescription+xml" href="http://www.april1985.com/atom.xml" title="我是思聪"><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-129409069-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129409069-1');
</script>


<script>
  (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();
  </script></head><body><header class="feature-header"><nav class="component-nav"><ul><div class="logo-container"><a href="/"><h2 class="title">我是思聪</h2></a></div><a href="/" target="_self" class="li component-nav-item"><p>现在</p></a><a href="/archives" target="_self" class="li component-nav-item"><p>曾经</p></a><ul class="shortcut-icons"><a href="https://github.com/derekhe" target="_blank"><img src="/images/github.svg" class="icon"></a><a href="/atom.xml" target="_blank"><img src="/images/rss.svg" class="icon"></a></ul></ul></nav></header><main class="container"><div id="body-container"><div id="post-list" class="left"><div class="home post-list"><div class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/post/2015-12-21-emei-mountain-2/" class="post-title-link">乐山峨眉游（2）</a></h2><div class="post-info">Dec 21, 2015</div><div class="post-content"><p>第二天早上不慌不慢，快要10点钟过去游客中心买票上车，淡季110+90车费。票价默认给你加5块钱，我明确说不要保险，就省了10块钱保险费，真的没啥必要。从游客中心到零公里坐车要一个多小时，还好自己没开车。</p>
<p>到达零公里的时候就要换车了，由于一些人是没有买门票的所以在这里需要补票。还好我们是买了票的，检票的有两个地方，运气比较好的是第二条线没有排多长，抱着儿子赶紧跑过去，抢了个前面的地方。检票几分钟就过了，换另外个大巴车上车。中途有一个小插曲，一个拿本地身份证的人在检票口过不去，因为人对不上号，被要求重新补票。在山脚下就有很多人兜售这样的票，如果不是本地身份证这里就傻了。</p>
<a id="more"></a>

<p>冬季由于山上积雪，车只能停到零公里。旅游车刚上去一点路，就开始挂雪地链了。一路又花费一个小时，到了雷洞坪，已经12点了。</p>
<p>下车给小孩拉个尿，在<a href="http://www.dianping.com/shop/19717114" target="_blank" rel="noopener">全福商务酒店</a>休息一下。本来背了两盒自热米饭，准备山顶吃的，但老婆觉得该吃饭了，那就吃吧。现在的旅游比之前规范了很多，什么东西都是明码标价，而且分量也是标准的，看来之前肯定是坑了很多人然后政府出来规范的。点了两个菜，都不错，分量确实也不错，三个人吃了42块钱。老板和我们一桌吃饭，他说今天天气好，上面有太阳，哇塞！我们又再问现在滑雪还来得及不，他说不行。上了金顶就没时间了。而且滑雪一个小时的免费，等弄好器具都20分钟了，再滑一下就一两个小时过去了，然后就收钱了，哈哈。老板真实在。</p>
<p>在雪地上一定要冰爪，否则滑你没商量。上次在海螺沟就幸好买了几个便宜的，要不然根本没法走。后来老爸做了好几个简易的，这次又派上用场了。</p>
<p>从雷洞坪到金顶缆车还有一段路程（地图上显示1.1公里），在冰雪上面带着小孩走了接近一个小时，一路上吵着要买铲子。还好丁仔比较坚强，一路到头。路上的猴子还好啦，没有生态猴区那么猛，很温顺。</p>
<p><img src="/images/2015/12/IMG_0241.jpg" alt="猴子必不可少"><br><img src="/images/2015/12/IMG_0245.jpg" alt="猴子必不可少"><br><img src="/images/2015/12/IMG_0250.jpg" alt="猴子必不可少"></p>
<p>出太阳啦！！！<br><img src="/images/2015/12/IMG_0248.jpg" alt="出太阳啦"></p>
<p>坐到缆车已经是两点钟了，时间过得真快。我们坐的不是那个很大的缆车，好像冬天没有开。缆车风景非常漂亮，只是缆车速度很快，有些接头的地方抖一抖吓死人。</p>
<p><img src="/images/2015/12/IMG_0253.jpg" alt><br><img src="/images/2015/12/IMG_0256.jpg" alt><br><img src="/images/2015/12/IMG_0257.jpg" alt><br><img src="/images/2015/12/IMG_0258.jpg" alt><br><img src="/images/2015/12/IMG_0262.jpg" alt></p>
<p>小朋友上山以后就有点走不动了，原来是脚趾头受伤了。一路上试着抱着背着，好累。来，做几个雪球。</p>
<p><img src="/images/2015/12/IMG_0274.jpg" alt><br><img src="/images/2015/12/IMG_0283.jpg" alt></p>
<p>这次运气真的很好，金顶上阳光很足，云海非常漂亮。除了坐飞机，这是第一次看到这么漂亮的云海。可以看到远处的瓦屋山，甚至更远的贡嘎山。</p>
<p><img src="/images/2015/12/IMG_0287.jpg" alt><br><img src="/images/2015/12/IMG_0288.jpg" alt></p>
<p>全景：<br><img src="/images/2015/12/IMG_0291.jpg" alt><br><img src="/images/2015/12/IMG_0292.jpg" alt><br><img src="/images/2015/12/IMG_0293.jpg" alt><br><img src="/images/2015/12/IMG_0294.jpg" alt><br><img src="/images/2015/12/IMG_0295.jpg" alt></p>
<p>猜猜这是什么山？<br><img src="/images/2015/12/IMG_0301.jpg" alt></p>
<p>有两个平顶的山，这个的是瓦屋山<br><img src="/images/2015/12/IMG_0311.jpg" alt></p>
<p>这个是什么山呢？</p>
<p><img src="/images/2015/12/IMG_0318.jpg" alt></p>
<p>问问[度娘]（<a href="http://tieba.baidu.com/p/833837251）" target="_blank" rel="noopener">http://tieba.baidu.com/p/833837251）</a></p>
<p>一路上小朋友都想要铲雪的铲子，想了好久，路上问了小卖部没得卖。好吧，只能打劫一个了。遇到了一个美女背一个小孩，看起来也是背个铲子多事的，给了25块钱买了个铲子。这下丁仔满意了，一路上当铲雪工，非常高兴。</p>
<p><img src="/images/2015/12/IMG_0325.jpg" alt></p>
<p>阳光下的金顶非常漂亮，但是小朋友有点害怕。十年前和朋友夏天来这里的时候，全是雾气，一点都不壮观。这次非常的通透，当然上面的雪也已经比较硬了，风也非常大，冷风就像刀割一样。</p>
<p><img src="/images/2015/12/IMG_0319.jpg" alt><br><img src="/images/2015/12/IMG_0330.jpg" alt></p>
<p>勤劳的铲雪工<br><img src="/images/2015/12/IMG_0339.jpg" alt></p>
<p>月亮都能看到啦<br><img src="/images/2015/12/IMG_0342.jpg" alt></p>
<p>刚好挡着太阳，感觉像是发光一样<br><img src="/images/2015/12/IMG_0345.jpg" alt><br><img src="/images/2015/12/IMG_0346.jpg" alt><br><img src="/images/2015/12/IMG_0347.jpg" alt><br><img src="/images/2015/12/IMG_0348.jpg" alt><br><img src="/images/2015/12/IMG_0349.jpg" alt></p>
<p>3点50左右，赶紧下山，因为观光车5点钟就要收车了。一路上背着丁丁赶路下去，坐缆车，继续赶路，最后4点40多到车站。仔仔已经冷的双手发冷，玩了一个雪球以后看起来没精神了，抱在怀里睡了一觉。之前都是老婆抱的，这次我来抱，足足站了半个多小时，终于上了车。今天由于有一些活动，搞得观光车有点接不上气，排队排的很远，还好我们下去的稍微早点，要不然更惨。</p>
<p>一坐上车小宝就醒了，一路上精神得很。一路上我都试着睡觉，但山路甩得我都晕晕的想吐，只有不睡，看着路，很难受。这个状态是没法回成都了。下山到客运中心已经是7点过了，还是决定就住下吧。吃了个<a href="http://www.dianping.com/shop/19106338" target="_blank" rel="noopener">3077烧烤麻辣烫排档</a>，不怎么好吃，拿上来就冷了，又辣得要死，没啥特色。给小孩点的蛋炒饭还行。</p>
<p>晚上住在<a href="http://hotels.ctrip.com/hotel/1562112.html#ctm_ref=hod_sr_lst_dl_n_1_1" target="_blank" rel="noopener">橡树缘连锁</a>地中海主题，也是直接过去订房，由于是周日了，所以价格也便宜150住一晚。房间装修还算比较有风格，但空调也是响，由于不是变频空调，突然制热响一下吓一跳。其他东西还算可以吧，卫浴都是TOTO的，但不知道为啥烧水一直有一股烧糊的怪味，很奇怪。没注意到上一家酒店也是不是这样。这个亲子房有一个1.5米的床，有一个1.2米的。我睡1.2米的被子，但被子短了，郁闷。</p>
<p>睡好觉，周一回成都，在乐山买了<a href="http://www.dianping.com/shop/5383680" target="_blank" rel="noopener">王浩儿纪六孃(致江路总店)</a>买了鸭子，在<a href="http://www.dianping.com/shop/27272047" target="_blank" rel="noopener">乡村黑豆花佛光路店</a>吃了中午饭，很棒，然后就回成都了。</p>
<p>累死哥哥了。。。。</p>
</div></article></div><div class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/post/2015-12-21-emei-mountain-1/" class="post-title-link">乐山峨眉游（1）</a></h2><div class="post-info">Dec 21, 2015</div><div class="post-content"><p>峨眉山半价，走起！我从来都是不打不准备的仗，周五发红包给公司群，同事推荐了好多地方，花点钱真心不错。周六早上出发开车到乐山，中午就到乐山。下了高速赶紧定位到古市香跷脚牛肉，大众点评上有个订座的功能，开车半个小时到地方。</p>
<p>不得不说这个地方真的很火，在一条小巷子里面，有点不方便开车。在河边有免费停车的地方，，还算比较方便。下了车到店，发现这个不是一般的热闹，排号都排了很长。还好我是大众点评上先预定了的，马上安排座位，等了大概10分钟，还算幸福的啦。</p>
<a id="more"></a>

<p>牛杂牛肉粉蒸牛肉，依次点起！</p>
<p><img src="/images/2015/12/IMG_0151.jpg" alt><br><img src="/images/2015/12/IMG_0152.jpg" alt><br><img src="/images/2015/12/IMG_0154.jpg" alt><br><img src="/images/2015/12/IMG_0156.jpg" alt></p>
<p>房顶也有特色</p>
<p><img src="/images/2015/12/IMG_0159.jpg" alt><br><img src="/images/2015/12/IMG_0160.jpg" alt></p>
<p>外面卖的泡菜，要钱的哟，没点<br><img src="/images/2015/12/IMG_0164.jpg" alt><br><img src="/images/2015/12/IMG_0171.jpg" alt></p>
<p>吃好了一顿，也就100多块钱，非常的爽。牛杂我只吃牛肚，但牛肉吃了很多，粉蒸肉也吃完了，哈哈。</p>
<p>下午决定还是去乐山大佛一趟，去峨眉爬山时间肯定是不够了。车停在乐山大佛景区门口的景园停车场，20块钱的停车费，要了发票（这是我的特点，一定要发票），居然是那种餐饮样式的发票，盖章倒是正规的，还有刮奖。我的运气还算不错，一 5块，嘿嘿。</p>
<p>乐山大佛我倒是很小的时候去过，已经没有记忆了，只有照片。现在自己有了儿子，带着儿子重温我小时候的记忆。</p>
<p><img src="/images/2015/12/IMG_0181.jpg" alt="乐山大佛"></p>
<p>小朋友还是挺厉害的，自己爬山到顶上。下栈道就有点郁闷了，第一个转弯就堵了，半天不动。想想这还是个普通的周末，要是黄金周我看怎么办。走到一半才发现，台阶太陡，路越来越窄，只有够一个人，老婆提着儿子往下走，真的有点艰难。</p>
<p><img src="/images/2015/12/IMG_0215.jpg" alt="乐山大佛"><br><img src="/images/2015/12/IMG_0221.jpg" alt="乐山大佛"><br><img src="/images/2015/12/IMG_0223.jpg" alt="下山栈道"><br><img src="/images/2015/12/IMG_0225.jpg" alt="乐山大佛"></p>
<p>下山以后去峨眉山了，天色有点晚，还没订酒店。酒店的问题真是让我头痛，以前遭过两次，订了酒店没法取消，小孩生病没法去，白白的损失了一千多。这算是峨眉山旅游淡季了，应该没有那么挤。到了峨眉山脚下再找酒店，发现很多酒店都没了。也没关系，一家一家的打电话，最后找到了<a href="http://hotels.ctrip.com/hotel/447011.html#ctm_ref=www_hp_bs_lst" target="_blank" rel="noopener">“凤缘酒店”</a>还有房间。</p>
<p>老婆上去看了下房间，找了一间还不错的。讲价128一晚，携程上面订的的话要168的。停车还算不错了，虽然酒店门口只有三个位置，但后面一条巷子还有很大的停车场。老板一起带过去，免费停。房屋临街，但隔音做的不错不吵。房间有一点霉味，其他都还算好了。空调也不错，只是晚上有一些噪音，后来索性关了空调。</p>
<p>在老板娘那里订了灵秀温泉的票，网上买138，这里买125。后来才知道我们的价格也有点贵了，在外面有一个小超市门口有一个牌牌写的110-125，110块钱其实也能买到。晚上随便在外面找个了餐厅，结果找了个巨难吃的地方，详见<a href="http://www.dianping.com/shop/44082643" target="_blank" rel="noopener">我的点评</a>：</p>
<blockquote>
<p>在这里吃过，价格比较贵不说，还做的相当难吃。<br>凤尾炒的全是烂七八糟的，酸菜粉丝汤的粉丝也是一股怪味，甚至酸菜里面还有一些清凉油的味道。最奇葩的苦笋，一股清凉油的味道，老板还是绝对是对的，也是醉了。。。，再也别去这里了</p>
</blockquote>
<p>晚上去泡温泉，温泉距离酒店还是有一点距离，走路10分钟。大冬天的好冷啊。换了票进去，每个人要把鞋子脱了给你一个号。原来是因为后续你可以用这个号开关门，然后还可以买东西，最后出来的时候拿鞋子给钱。换衣服的地方还不是很冷，要主动去要浴袍，一个人只能拿一次干的。</p>
<p>温泉还是可以的，小孩的游泳圈没有带，有点郁闷。在外面的温泉玩了一下，赶紧到室内的温泉。室内的就要好很多了，泡了一个多小时，没有太大的感觉，回去赶紧再冲个热水澡。。。。</p>
<p>晚上睡了个好觉，准备第二天爬山。</p>
</div></article></div><div class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/post/2015-07-20-android-offline-download/" class="post-title-link">Android SDK Offline Download</a></h2><div class="post-info">Jul 20, 2015</div><div class="post-content"><p><a href="https://github.com/derekhe/android-sdk-offline" target="_blank" rel="noopener">Github Repo</a></p>
<p>Updated:</p>
<blockquote>
<p>做出这个工具后，我司达人告诉我，只需要把SDK Manager代理服务器设置为<a href="http://www.google.cn或者其国内IP即可，速度可以达到满格。在电信网络中测试，果然很霸道，请大家尝试。" target="_blank" rel="noopener">www.google.cn或者其国内IP即可，速度可以达到满格。在电信网络中测试，果然很霸道，请大家尝试。</a></p>
</blockquote>
<p>由于Google被GFW的问题Android SDK下载速度总是非常的慢，甚至用了<a href="http://www.androiddevtools.cn/" target="_blank" rel="noopener">代理服务器</a>速度也很慢，因为是单线程的。我写了这个工具，可以在线生成需要的SDK的下载链接，这样就可以方便的用你喜欢的工具下载了（迅雷和QQ旋风速度都很不错）。<br>如果还不能下载，则可以在下载工具中设置代理服务器，让其进行多线程下载，速度也非常理想。</p>
<a id="more"></a>

<p>This tool help to you generate latest offline down links for Android SDK. This is helpful when you don’t have internet access or speed is low.</p>
<p>You can use your favorite download tool to download them. Then put these downloaded files into sdk/temp folder and open Android SDK Manager. Click the items in Android SDK Manager, it will read from your downloaded cache.</p>
<p>If your can’t get the Android SDK Manager items or if they are not update, or the download speed is slow, please try to use the <a href="http://www.androiddevtools.cn/" target="_blank" rel="noopener">proxy listed here</a></p>
<h1 id="Online-site-在线网址"><a href="#Online-site-在线网址" class="headerlink" title="Online site 在线网址"></a>Online site 在线网址</h1><p><a href="http://www.april1985.com/android-sdk-offline/">http://www.april1985.com/android-sdk-offline/</a></p>
<h1 id="Clone-and-run-locally"><a href="#Clone-and-run-locally" class="headerlink" title="Clone and run locally"></a>Clone and run locally</h1><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/derekhe/android-sdk-offline.git</span><br><span class="line">npm <span class="keyword">install</span></span><br><span class="line">cd web</span><br><span class="line">bower <span class="keyword">install</span></span><br><span class="line">cd ..</span><br><span class="line">npm <span class="keyword">install</span> -g <span class="keyword">http</span>-<span class="keyword">server</span></span><br><span class="line">//You may need <span class="keyword">to</span> <span class="keyword">set</span> proxy <span class="keyword">if</span> your network <span class="keyword">is</span> blocked</span><br><span class="line">npm run generate</span><br><span class="line">npm run serve</span><br></pre></td></tr></table></figure>

<p>open your browser and navigate to localhost:8080</p>
</div></article></div><div class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/post/2015-06-28-hack-waveshare-touchscreen/" class="post-title-link">WaveShare 7-inch user space driver 微雪7寸触摸驱动</a></h2><div class="post-info">Jun 28, 2015</div><div class="post-content"><p><a href="https://github.com/derekhe/waveshre-7inch-touchscreen-driver/" target="_blank" rel="noopener">Github Repo</a></p>
<p>I brought a <a href="http://www.waveshare.net/shop/7inch-HDMI-LCD-B.htm" target="_blank" rel="noopener">WaveShare 7-inch HDMI LCD</a> and it provides a USB touchscreen.<br>But the company only provide binary driver and images, which is quite bad. Installing binary driver will break self compiled kernel, and you can’t get updated kernels.<br>I asked the company to provide the source code but they refused. They said they won’t provide any source code because other companies can copy very fast so that their products can’t sell out at good price.</p>
<p>OK. If they company won’t want to provide anything, that’s fine. I finally find out we can still drive the touchscreen by writing a user space driver.</p>
<p>Tested using official image: 2015-05-05-raspbian-wheezy.img</p>
<a id="more"></a>

<h1 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h1><p>ssh into your raspiberry</p>
<p>clone this repo into any dir,then</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">chmod +x install.sh</span><br><span class="line">./install.sh</span><br><span class="line"></span><br><span class="line">sudo restart</span><br></pre></td></tr></table></figure>

<h1 id="How-do-I-hack-it"><a href="#How-do-I-hack-it" class="headerlink" title="How do I hack it"></a>How do I hack it</h1><p>By looking at the dmesg information, we can see it is installed as a hid-generic driver, the vendor is 0x0eef(eGalaxy) and product is 0x0005.<br>0x0005 can’t be found anywhere, I think the company wrote their own driver to support this.</p>
<h2 id="dmesg-infomation"><a href="#dmesg-infomation" class="headerlink" title="dmesg infomation"></a>dmesg infomation</h2><figure class="highlight cs"><table><tr><td class="code"><pre><span class="line">[<span class="meta">    3.518144</span>] usb <span class="number">1</span><span class="number">-1.5</span>: <span class="keyword">new</span> full-speed USB device number <span class="number">4</span> <span class="keyword">using</span> dwc_otg</span><br><span class="line">[<span class="meta">    3.606036</span>] udevd[<span class="number">174</span>]: starting version <span class="number">175</span></span><br><span class="line">[<span class="meta">    3.631476</span>] usb <span class="number">1</span><span class="number">-1.5</span>: New USB device found, idVendor=<span class="number">0</span>eef, idProduct=<span class="number">0005</span></span><br><span class="line">[<span class="meta">    3.641195</span>] usb <span class="number">1</span><span class="number">-1.5</span>: New USB device strings: Mfr=<span class="number">1</span>, Product=<span class="number">2</span>, SerialNumber=<span class="number">3</span></span><br><span class="line">[<span class="meta">    3.653540</span>] usb <span class="number">1</span><span class="number">-1.5</span>: Product: By ZH851</span><br><span class="line">[<span class="meta">    3.659956</span>] usb <span class="number">1</span><span class="number">-1.5</span>: Manufacturer: RPI_TOUCH</span><br><span class="line">[<span class="meta">    3.659967</span>] usb <span class="number">1</span><span class="number">-1.5</span>: SerialNumber: \xffffffc2\xffffff84\xffffff84\xffffffc2\xffffffa0\xffffffa0B54711U335</span><br><span class="line">[<span class="meta">    3.678577</span>] hid-generic <span class="number">0003</span>:<span class="number">0</span>EEF:<span class="number">0005.0001</span>: hiddev0,hidraw0: USB HID v1<span class="number">.10</span> Device [RPI_TOUCH By ZH851] <span class="keyword">on</span> usb-bcm2708_usb<span class="number">-1.5</span>/input0</span><br></pre></td></tr></table></figure>

<p>kernel config provide us more clue:</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">CONFIG_USB_EGALAX_YZH</span>=y</span><br></pre></td></tr></table></figure>

<p>It is really a eGalaxy based device. Google this config but found nothing. I don’t have a eGalxy to compare, maybe waveshare’s touchscreen is only modifed the product id.</p>
<p>Then I look at the response of hidraw driver:</p>
<h2 id="hidraw-driver-analysis"><a href="#hidraw-driver-analysis" class="headerlink" title="hidraw driver analysis"></a>hidraw driver analysis</h2><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">pi@raspberrypi ~/python $ sudo xxd -c 25 /dev/hidraw0</span><br><span class="line">0000000: aa00 0000 0000 bb00 0000 0000 0000 0000 0000 0000 0000 0000 00  <span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span>.</span><br><span class="line">0000019: aa01 00c5 0134 bb01 0000 0000 0000 0000 0000 0000 0000 0000 cc  <span class="built_in">..</span><span class="built_in">..</span>.4<span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span>.</span><br></pre></td></tr></table></figure>

<p>You can try by your self, by moving the figure on the screen you will notice the value changes.<br>Take one for example:</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">0000271: aa01 00e4 0139 bb01 01e0 0320 01e0 0320 01e0 0320 01e0 0320 cc  <span class="built_in">..</span><span class="built_in">..</span>.9<span class="built_in">..</span><span class="built_in">..</span>. <span class="built_in">..</span>. <span class="built_in">..</span>. <span class="built_in">..</span>. .</span><br></pre></td></tr></table></figure>

<p>“aa” is start of the command, “01” means clicked while “00” means unclicked. “00e4” and “0139” is the X,Y position (HEX).<br>“bb” is start of multi-touch, and the following bytes are the position of each point.</p>
<h2 id="Write-the-driver"><a href="#Write-the-driver" class="headerlink" title="Write the driver"></a>Write the driver</h2><p>I use python to read from hidraw driver and then use uinput to emulate the mouse. It is quite easy to do. Please look at the source code.</p>
<h2 id="Other-systems"><a href="#Other-systems" class="headerlink" title="Other systems"></a>Other systems</h2><p>I think this driver can work in any linux system with hidraw and uinput driver support.</p>
<h2 id="Calibration-and-Multitouch"><a href="#Calibration-and-Multitouch" class="headerlink" title="Calibration and Multitouch"></a>Calibration and Multitouch</h2><p>Please try this driver and if you need to support multitouch and calibration, please <a href="derekhe@april1985.com">contact me</a> to get the pro version.</p>
<h2 id="Other-displays"><a href="#Other-displays" class="headerlink" title="Other displays"></a>Other displays</h2><p>I received an email from Adam, this driver may work with another type of screen:</p>
<blockquote>
<p>Hi there. Wanted to say thank you for writing and sharing the user space driver for 7” USB touchscreen, you have saved me!</p>
</blockquote>
<blockquote>
<p>Mine is branded Eleduino (see here for details: <a href="http://www.eleduino.com/5-Inch-HDMI-Input-Touch-Screen-for-Raspberry-PI-2-B-B-and-Banana-pro-pi-p10440.html" target="_blank" rel="noopener">http://www.eleduino.com/5-Inch-HDMI-Input-Touch-Screen-for-Raspberry-PI-2-B-B-and-Banana-pro-pi-p10440.html</a>) and I had exactly the same issue - closed source binary driver which simply replaced kernel modules.</p>
</blockquote>
<blockquote>
<p>Your solution worked out of the box, and didn’t even need calibration.</p>
</blockquote>
<blockquote>
<p>You’re a hero!</p>
</blockquote>
</div></article></div><div class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/post/2015-06-13-3d-printing-problems/" class="post-title-link">3D打印的各种问题及解决方案</a></h2><div class="post-info">Jun 13, 2015</div><div class="post-content"><p>3D打印机已经买回来几个月了，基本上每天都要打印一些东西，期间遇到了很多的问题积累了很多的经验。虽然现在桌面级的3D打印也算是比较简单好用了，但要追求好一点的打印质量，还是得折腾。</p>
<a id="more"></a>

<h1 id="打印校准"><a href="#打印校准" class="headerlink" title="打印校准"></a>打印校准</h1><p>打印机的校准包括X、Y、Z和A、B（就是喷头）两个轴的校准。最重要的是XYAB，因为他们直接关系到打印的尺寸大小及表面质量。</p>
<p>Cura和Slic3r等工具导出的是GCODE格式。GCODE格式使用明文描述路径。Sailfish Firmware只支持X3G文件，是一种二进制文件。由于打印机所使用的CPU速度较慢，处理文件并转换成脉冲比较慢，会影响打印质量。所以使用<a href="https://github.com/whpthomas/GPX" target="_blank" rel="noopener">GPX</a>工具将GCODE转换为X3G后，每个指令所走的位置都已经转换成脉冲，甚至可以对一些路径进行加减速的处理。打印机的CPU就可以直接的读取脉冲并控制电机运动。</p>
<h2 id="XY-steps-mm矫正"><a href="#XY-steps-mm矫正" class="headerlink" title="XY steps/mm矫正"></a>XY steps/mm矫正</h2><p>在转换的过程中，XY的steps per mm这个参数非常重要，讲的是走一个毫米需要多少的脉冲，如果该值过小，则会少走一些距离，造成距离偏小。这个和机器的结构有一定的关系，牵扯到同步齿的齿数、电机的参数等，<a href="http://prusaprinters.org/calculator/" target="_blank" rel="noopener">RepRap Calculator</a>提供了这个参数的计算器，非常方便。</p>
<p><img src="/images/2015/06/calculator.jpg" alt="计算器配图"></p>
<p>MBot最初用的是17齿的齿轮，和Replicator是一样的。后来经过改进用了18齿的齿轮，和Replicator 2是一样的。通过计算器可以看到，88.89 steps/mm是理论值，但是MBot和Replicator 2中用的是<a href="https://github.com/whpthomas/GPX/blob/master/gpx.c" target="_blank" rel="noopener">88.573186这个值</a>。和88.89比较起来，会少走一些距离，导致最后打印尺寸偏小。<a href="https://github.com/dcnewman/GPX" target="_blank" rel="noopener">dcnewman</a>开发的GPX提供了正确的参数，但截至目前尚有一些问题，不建议使用。</p>
<p>为了矫正88.57带来的误差，可以采用自定义的配置文件进行配置。<a href="https://github.com/derekhe-3dprinting/print-settings/blob/master/mbot.ini" target="_blank" rel="noopener">mbot.ini</a>是我的Mbot Cube的配置文件，在使用gpx的时候，指定gpx -c mbot.ini xxxx.gcode即可正确转换。</p>
<p>当然你的打印机可能依然不是正确的，需要使用一些工具进行矫正。传统的做法是使用<a href="http://www.thingiverse.com/download:139958" target="_blank" rel="noopener">20mm calibration box</a>，测量外观尺寸。但这样做有一个缺点，由于喷头挤出的塑料可能有误差，会造成纠正的值将外壳的误差也算进去了。正确的测量方式是使用<a href="https://www.youmagine.com/designs/calibration-sticks" target="_blank" rel="noopener">calibration sticks</a>，根据不同的打印平台的长度，分别进行XY的测量，然后测量出两个缺口的距离。这样可以排除喷头的误差。</p>
<p><img src="https://d36c0vbvwjb9cx.cloudfront.net/uploads/image/file/60970/medium_9001test.JPG" alt="Calibration-sticks"></p>
<p>我的打印机使用88.89，打印出来的距离正确。</p>
<h2 id="AB轴喷头纠正"><a href="#AB轴喷头纠正" class="headerlink" title="AB轴喷头纠正"></a>AB轴喷头纠正</h2><p>喷头的step per mm会对挤出的塑料的多少有影响，在机械结构不变的情况下，该值越大，则挤出的料越多。过多的料称之为过挤出，会造成外观尺寸偏大，内圆半径变小，顶层可见各种重叠的塑料；<a href="http://support.3dverkstan.se/article/23-a-visual-ultimaker-troubleshooting-guide#underextrusion" target="_blank" rel="noopener">挤出过小</a>，会造成外观尺寸变小，内圆半径变大，<a href="http://support.3dverkstan.se/article/23-a-visual-ultimaker-troubleshooting-guide#pillowing" target="_blank" rel="noopener">顶层可以见各种孔洞</a>。正确的喷头参数，会对打印质量造成非常大的影响。</p>
<p><a href="http://www.thingiverse.com/thing:52946" target="_blank" rel="noopener">Calibrate your 3D printer</a>提供了调整喷头的参数方法，当然这篇文章也提到了如何修正其它参数。还有<a href="https://www.youtube.com/watch?v=YUPfBJz3I6Y" target="_blank" rel="noopener">一种普遍使用的方式</a>是在材料上做好标记，然后走10cm，测量实际走的长度。当然对于不能用print run的打印机，我写了一个<a href="https://github.com/derekhe-3dprinting/print-settings/blob/master/E-calibration.gcode" target="_blank" rel="noopener">gcode文件</a>，执行后会自动走10cm，然后测量实际的长度。我的打印机是正确的，所以对于喷头也不用做过多的处理。</p>
<h1 id="孔偏小"><a href="#孔偏小" class="headerlink" title="孔偏小"></a>孔偏小</h1><p>打印中非常常见的问题是孔变小，通常孔会变小0.5mm左右，如果打印<a href="http://www.thingiverse.com/download:139973" target="_blank" rel="noopener">这个图形</a>，很可能会发现无法插上。测量孔的直径，会发现孔小0.5mm，而柱子的直径是正常的。<br><img src="http://thingiverse-production-new.s3.amazonaws.com/renders/59/ea/10/fe/a5/test_plug_preview_featured.jpg" alt="测试图形"></p>
<p>我在MBot Cube打印，结果是这样。然而在FlashForge Creator Pro上面，则两个可以插上。这个问题困扰了我很久，至今还没有解决。试过将同样的gcode文件分别转换成两种机型的x3g进行打印，还是一样，所以可以排除一些切片器的问题。在研究这个问题中，有一些文章可以参考。</p>
<ul>
<li><a href="http://www.thingiverse.com/thing:52946/#instructions" target="_blank" rel="noopener">Calibrate your 3D printer to print parts to fit</a></li>
<li><a href="http://reprap.org/wiki/ArcCompensation" target="_blank" rel="noopener">ArcCompensation</a></li>
<li><a href="http://manual.slic3r.org/troubleshooting/dimension-errors" target="_blank" rel="noopener">Dimension Errors</a></li>
<li><a href="http://www.deltarap.org/printing-undersized-holes/" target="_blank" rel="noopener">Are you printing undersized holes ?</a><br>这篇文章的神奇之处在于他的外径和内径都是OK的，可能和他使用的Cura的Sublime版本有关系。其中提到的<blockquote>
<p>use Flow_tweak-post-processor and decrease perimeter flow rate as described above in case of holes coming out too small.<br>或许又是另外一种解决方案。</p>
</blockquote>
</li>
</ul>
<p>虽然我没用过最终解决这个问题，但以下是有一些方法可以改善这种问题：</p>
<ul>
<li><p>改变挤出量<br>在Cura和Slic3r中，都有改变挤出量的选项。甚至在Simplify3D中，PLA材料的默认挤出量就是90%。经过测试，90%的挤出量比较合适，打出来的测试块刚好可以卡上。但是外观尺寸会同样变小0.2mm，内圆仍然小0.2mm，但圆柱也同样会小0.2mm，这样两个尺寸就刚好能够插入。更小的挤出量则会带来一些问题，不推荐设置。<br>改变挤出量虽然能够缓解一些圆孔的问题，但也会影响顶层的质量。为了弥补这样的缺陷，只能将顶层的厚度设置为1mm，或者5层。这样顶层基本上就密闭了。</p>
</li>
<li><p>喷头形状<br>打印<a href="http://www.thingiverse.com/thing:533472" target="_blank" rel="noopener">negative_space_tolerance_test.stl</a>，我的打印机只能拆下来2个，只能说打印质量比较差。通过很多次的对比，发现喷头的Flat tip area（见下图）的大小会影响到tolerance的，厂商已经在着手改进中了。</p>
</li>
</ul>
<p><img src="http://static.creativetools.se/image/cache/data/CMR/nozzle_02mm/add_img/nozzle_02_-1280x720.jpg" alt="喷头"></p>
<ul>
<li><p>XY Size Compensation<br>Slic3r中提供了一个XY Compensation的选项，在<a href="http://manual.slic3r.org/troubleshooting/dimension-errors" target="_blank" rel="noopener">Dimension Errors</a>中有提到。和改变挤出量不一样，这个直接对切片后的图形进行补偿，不会产生顶层孔洞的问题。<br>在目前的Cura中还没提供这样的功能，但在Cura的开发15.06版本中，已经准备提供类似功能。Simplify3D在最新的版本中已经提供。</p>
</li>
<li><p>从设计上规避<br>在设计的阶段就根据孔的大小预留一些空间，但这样对于别人已经设计好的模型就很难修正了。并且你的打印机的修正量不一定适合别人。</p>
</li>
</ul>
<h1 id="圆不是圆"><a href="#圆不是圆" class="headerlink" title="圆不是圆"></a>圆不是圆</h1><p>你可能会发现打印园的起始的连接部位会有一些凸起，并且圆可能是椭圆。如果观察一下打印时候的速度及噪音，你会发现在打印圆的时候可能会嘎吱嘎吱的响。这是因为园会拆分成多条直线，导致每条直线会起起停停，在速度较高的时候可能会造成一些丢步或者抖动。解决方法是打印周长的时候，选择小一些的速度，例如40mm/s，这样打印质量就会很好了。观察Simplify3D的GCODE，发现它可能对不同的周长做了不同的处理，小的圆弧走的速度较慢，打印质量很好。</p>
<h1 id="顶层的洞"><a href="#顶层的洞" class="headerlink" title="顶层的洞"></a>顶层的洞</h1><p>如果挤出正常，顶层出现孔洞，则需要将Top/Bottom的层数设置得更好，一般1mm左右能够得到很好的效果。另外infill的百分比也比较影响，因为infill很低(10%以下）的时候，打印Top的时候就会变成Bridge，造成打印质量下降。</p>
<h1 id="打印错层"><a href="#打印错层" class="headerlink" title="打印错层"></a>打印错层</h1><p>Sailfish Firmware中有一个<a href="http://www.sailfishfirmware.com/doc/parameters-acceleration.html#x21-590004.3" target="_blank" rel="noopener">Accerlation</a>的选项，该选项打开时固件会根据当前的GCODE生成相应地加速度，使得打印机在降速和提速的时候，能够平稳的以一定的加速度进行提速。关闭时，会始终以电机的最大能力作为最大加速度进行加减速，当电机无法接受预定的速度时，会造成丢步，久而久之积累下造成打印错层。</p>
<h1 id="打印机噪音"><a href="#打印机噪音" class="headerlink" title="打印机噪音"></a>打印机噪音</h1><p>我的打印机一直有嘎嘎嘎的噪音，晚上打印的时候声音巨大，关上门隔一个屋子都能听到。轴承都是加了油还是一样。<br><embed src="http://www.tudou.com/v/M7R-H8fCi7Q/&resourceId=10747321_05_02_99&tid=0/v.swf" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" wmode="opaque" width="480" height="400"></p>
<p>经过排查，最终发现是中间的塑料块裂了。这个塑料块的非常重要，应该是和XY的垂直度有很大的关系。换了以后基本上就恢复了。</p>
<h1 id="第一层不粘连"><a href="#第一层不粘连" class="headerlink" title="第一层不粘连"></a>第一层不粘连</h1><p>第一层不粘连的问题，其实很头痛。和以下因素有关：</p>
<ul>
<li>喷头和第一层的高度<br>一般保持到一张纸的厚度即可。</li>
<li>第一层的挤出量。<br>一般选择200%的挤出量会好一些</li>
<li>温度<br>一般第一层温度保持在230度比较好</li>
<li>材料<br>材料的影响包括材料的好坏和颜色。有些材料表面粗糙，挤出后会不粘连，然后卷到喷头上，越卷越多，造成打印失败。<br>解决方法包括打印一个raft，减小速度</li>
</ul>
</div></article></div></div></div><div id="sidebar" class="left"><div id="about-panel"><div class="info"><div class="title">贺思聪</div><div class="bio">《爬虫实战：从数据到产品》作者，国内首个机票价格历史及预测小程序“爱飞狗旅行”作者，极客、架构师、大数据玩家。</div></div><img src="/images/avatar.png" class="avatar"></div><div id="friend-links-panel"><div class="panel-title"><p>LINKS</p></div><a href="http://github.com/derekhe" target="_blank" class="link-item"><div class="link-container"><div class="site-name">GitHub</div><div class="site-desc">http://github.com/derekhe</div></div></a><a href="http://www.jianshu.com/u/b1e713e56ea6" target="_blank" class="link-item"><div class="link-container"><div class="site-name">简书</div><div class="site-desc">http://www.jianshu.com/u/b1e713e56ea6</div></div></a><a href="https://www.linkedin.com/in/sicong-he-56a95437/" target="_blank" class="link-item"><div class="link-container"><div class="site-name">LinkedIn</div><div class="site-desc">https://www.linkedin.com/in/sicong-he-56a95437/</div></div></a></div></div></div><div class="clear"></div></main><footer class="footer-container"><div class="paginator"><a href="/page/4/" class="prev">PREV</a><a href="/page/6/" class="next">NEXT</a></div><div class="copyright"><p>© 2008 - 2019 <a href="http://www.april1985.com">贺思聪</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/AngryPowman/hexo-theme-prontera" target="_blank">hexo-theme-prontera</a>.</p></div></footer><script>var _mtac = {}; (function() {     var mta = document.createElement("script"); mta.src = "http://pingjs.qq.com/h5/stats.js?v2.0.2";    mta.setAttribute("name", "MTAH5");    mta.setAttribute("sid", "500490740");    var s = document.getElementsByTagName("script")[0];    s.parentNode.insertBefore(mta, s);})();</script></body></html>